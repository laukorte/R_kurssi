[["index.html", "Sosiaalitieteiden tilastollisten menetelmien R-harjoituskurssi, 2 op R-harjoituskurssi", " Sosiaalitieteiden tilastollisten menetelmien R-harjoituskurssi, 2 op Terhi Auvinen, Samuli Koponen, Lauri Kortelainen &amp; Antti Kouvo 2023-10-17 R-harjoituskurssi "],["tervetuloa-sosiaalitieteiden-r-kurssille.html", "Tervetuloa sosiaalitieteiden R-kurssille!", " Tervetuloa sosiaalitieteiden R-kurssille! Miksi R? R on ilmainen! If you are a teacher or a student, the benefits are obvious. Se toimii kaikissa tietokoneissa! Markkinoiden parhaat graafit! Ennennäkemättömän laaja vertaistukiverkosto! Sillä voi tehdä kaikki tilastolliset testit! "],["harjoituskerta-1.html", "1 Harjoituskerta 1 1.1 Yleiset asiat 1.2 Kyselytutkimus 1.3 R ja RStudio 1.4 Tietorakenteet 1.5 Työskentely R:ssä 1.6 Aineiston tuominen R:ään 1.7 Valmiin aineiston tuominen R:ään 1.8 Aineiston käsitteleminen 1.9 Valmiin aineiston tarkastelu 1.10 Uuden muuttujan luominen aineistoon 1.11 Muuttujan poistaminen aineistosta 1.12 Aineiston kuvailu", " 1 Harjoituskerta 1 Osa Käsiteltävät asiat (viitteellinen asiasisältö, muutoksia voi tulla) 1 RStudioon ja R-kieleen tutustuminen 2 Aineiston kuvailu: frekvenssijakauma, tunnusluvut, kuviot, osa-aineiston poimiminen ja aineston ryhmittäinen tarkastelu 3 Yksinkertaiset muuttujamuunnokset, kahden muuttujan välinen yhteisvaihtelu, ristiintaulukointi 4 Korrelaatiot ja hajotakuvio, summamuuttujan tekeminen 5 Keskiarvotestit: t-testi ja ANOVA 6 Kertausta ja ohjausta ryhmätehtävään Ohjelmassa tänään Päivän aikataulu Muita käytännön asioita Kurssin suorittaminen ja sisältö RStudion toimintojen esittely ja R-kielen perusteita Harjoitus / kotitehtävän tehtävänanto Tällä kerralla opimme perusteet: * mikä on R * miten luodaan muuttujia * miten muuttujia käsitellään * miten aineisto tuodaan R:ään * miten aineistoa käsitellään 1.1 Yleiset asiat 1.2 Kyselytutkimus Tilastollisen tutkimuksen (kyselytutkimuksen) perusjutuista harkiten kertausmateriaalia luentotallenteeksi 1.3 R ja RStudio Tähän Rstudion esittelyvideo Oheisessa kuvassa on esitetty Rstudion neljä tärkeintä kenttää: Vasemmassa ylänurkassa on konsoli (tai komentokehoite), johon käskyt kirjoitetaan ja tulostetaan Oikeassa ylänurkassa on projektin ympäristö, jossa näkyy kaikki projektin aineistot, muuttujat, vektorit, yms. Vasemmassa alanurkassa on projektin tiedostot Oikeassa alanurkassa on skripti, johon voidaan dokumentoida projektin kulkua, komennot, yms. Rstudion perusnäkymä 1.3.1 Konsoli R:n on komentopohjainen ohjelma, jonka käyttöliittymänä toimii komentoikkuna (Console). Siihen kirjoitetaan komennot ja komentojen tulokset tulostuvat myös komentoikkunaan. R:ää voidaan pitää “interaktiivisena laskukoneena” (Rajala 2001) ja komentojen lisäksi konsolia voidaankin käyttää yksinkertaisena laskimena. 1+2 ## [1] 3 1.3.2 Aineiston syöttäminen R:ään Edellä annettu komento laski yhteen luvut 1 ja 2 ja tulosti näiden summan. Näin toimittaessa tulos ainoastaan tulostetaan eikä se jää muistiin. R:lle pitääkin kertoa erikseen milloin tulos halutaan tallentaa muistiin. Arvon tallettaminen muuttujaan tapahtuu sijoitusoperaattorilla “&lt;-”. Luodaan seuraavaksi muuttuja nimeltään luku, jolle annetaan arvo yksi. Tämän jälkeen tulostetaan muuttujan sisältö kirjoittamalla muuttujan nimi ja ajamalla tämä komento. Monessa muussa ohjelmointikielessä muuttujan arvon tulostamiseen pitäisi kutsua erikseen tulostusfunktiota (kuten print), mutta R:ssä tämä ei ole tarpeellista. # Sijoitetaan luku 1 muuttujaan &#39;luku&#39; luku &lt;- 1 # Tulostetaan muuttujan &#39;luku&#39; sisältö luku ## [1] 1 Muuttuja luku sisältää nyt arvon 1 ja sitä voidaan käyttää viittamalla sen nimeen. Muuttujia voidaan käyttää laskuoperaatioissa numeroiden sijaan. Seuraavassa tulostetaan edellä luodun muuttujan arvo lisättynä kahdella. luku + 2 ## [1] 3 Alkuperäisen muuttujan arvo on edelleen yksi, koska yllä tehtiin vain tulostus. luku ## [1] 1 Tehdään uusi muuttuja luku2, johon talletetaan uusi tulos ja tulostetaan uuden muuttujan arvo. luku2 &lt;- luku + 2 luku2 ## [1] 3 HUOM! Jos samaan muuttujaan talletaan jokin muu luku tai tulos, R ei kysele käyttäjän tahtotilaa tai lupia, vaan tekee mitä pyydetään. Ole siis tarkkana, kun teet muuttujia! luku2 &lt;- luku + 5 luku2 ## [1] 6 Samalla logiikalla voidaan myös kopioida muuttuja sijoittamalla vanha muuttuja uuteen muuttujaan. luku3 &lt;- luku2 luku4 &lt;- luku2 Muuttujia voidaan poistaa komennolla rm() rm(luku3, luku4) 1.3.3 Esimerkki Komentoja voidaan käyttää myös funktion sisällä. Seuraavassa luodaan ensin tuhat havaintoa normaalijakautuneesta muuttujasta, jonka keskiarvo on 100 ja keskihajonta on 15. Sen jälkeen lasketaan muuttujan keskivirhe (= sd / n^0.5) käyttämällä hyväksi komentoja. aly &lt;- rnorm(1000, 100, 15) sd(aly) ## [1] 14.69902 length(aly) ## [1] 1000 sqrt(length(aly)) ## [1] 31.62278 se &lt;- sd(aly) / sqrt(length(aly)) # Huomaa, ettei tässä käytetä lukua 1000, vaan vektorin pituutta se ## [1] 0.4648238 1.3.4 R script Edellä komennot on annettu komentoikkunan kautta. Komennot voidaan suorittaa myös R scriptin avulla. Se vastaa SPSS:n syntaksia tai Stata do-filea. 1.4 Tietorakenteet Seuraavassa esitellään kurssin kannalta tärkeimpiä tietorakenteita. Näitä ovat erityisesti vektorit (vector) ja datakehikot (data.frame). Taulukkomuotoiset tilastolliset aineistot luetaan R:ään usein datakehikoksi, joiden sarakkeet ovat vektori-tietorakenteita. 1.4.1 Vektorit Vektori on R:n yksinkertaisin tietorakenne. Vektorit koostuvat alkioista ja alkiot ovat vektorissa tietyssä järjestyksessä. Vektori luodaan funktiolla c. Itse asiassa yllä luotu muuttujat ja luku ja lukuplus2 ovat vektoreita (ns. skalaarivektoreita), joiden pituus on yksi. Tällöin ei tarvitse käyttää funktiota c. Luodaan vektori, jossa on luvut 1, 3 ja 10 ja talletetaan se muuttujaan v1. v1 &lt;- c(1, 3, 10) v1 ## [1] 1 3 10 Edellä luotujen muuttujien tapaan myös vektoriin voidaan viitata pelkästään sen nimellä. v1 * 3 ## [1] 3 9 30 Tai.. v1 * luku2 ## [1] 6 18 60 Vektorin alkioihin viitataan hakasulkeilla. Tulostetaan edellä luodun vektorin toinen alkio. v1[2] ## [1] 3 Alkioihin viittaamalla voidaan myös korvata vektorin arvoja. v1[2] &lt;- 4 v1 ## [1] 1 4 10 Vektoreita voidaan luoda myös yhdistelemällä vektoreita. vektori &lt;- c(luku, luku2, v1) vektori ## [1] 1 6 1 4 10 Vektorin alkioiden täytyy olla aina samaa tietotyyppiä. Keskeisimmät tietotyypit ovat numeerinen eli reaaliluku (numeric), merkkijono (character) sekä looginen (logical). Edellä luodut vektorit olivat tietotyyppiä numeric. Vektori, joka on tietotyyppiä looginen, saa arvoja TRUE tai FALSE. Alla esimerkkejä vektoreista, jotka ovat tyypiltään merkkijonoja ja loogisia. Vektorin tietotyypin voi kätevästi selvitää funktion typeof avulla. Vektorin pituus saadaan selville käyttämällä funktiota length. library(tidyverse) # Selvitetään edellä luomamme vektori1:sen tietotyyppi typeof(v1) ## [1] &quot;double&quot; # Luodaan vektori, joka on tyypiltään merkkijono elaimet &lt;- c(&quot;kissa&quot;, &quot;koira&quot;, &quot;hiiri&quot;, &quot;elefantti&quot;) # varmistetaan tietotyyppi typeof-funktiolla typeof(elaimet) ## [1] &quot;character&quot; # Looginen tietotyyppi looginen &lt;- c(TRUE, FALSE, TRUE, TRUE, TRUE, FALSE, FALSE) looginen ## [1] TRUE FALSE TRUE TRUE TRUE FALSE FALSE typeof(looginen) ## [1] &quot;logical&quot; # Selvitetään aiemmin luotujen vektorien pituudet length(luku) ## [1] 1 length(v1) ## [1] 3 length(elaimet) ## [1] 4 length(looginen) ## [1] 7 Tietotyypin ja vektorin pituuden voi tarkistaa myös environment-välilehden alta, jossa on listattu kaikki vektorit, muuttujat, yms. Harjoitus: Kokeile R-studiossa luoda uusia vektoreita. Tutki niiden tietotyyppejä ja pituuksia. Mitä tapahtuu, jos luot vektorin arvoilla 2, “kissa”, 5? c(1, &quot;kissa&quot;) ## [1] &quot;1&quot; &quot;kissa&quot; 1.4.2 Datakehikko Edellä esitettyjä tietotyyppejä ei voi yhdistää yhdeksi matriisiksi. Sen sijaan datakehikossa tämä on mahdollista ja sen takia sitä onkin järkevä käyttää ihmistieteellisessä tutkimuksessa, jossa vastaukset voivat olla niin numeraalisia kuin tekstiäkin. 1.5 Työskentely R:ssä R käyttää työkansiota, johon se oletusarvoisesti tallentaa tiedostot ja joita se käyttää “juurena”. Esimerkiksi aineistoa tuodessa viitataan tähän kansioon, joten sen sijainti tulee olla selvillä. Työkansion polku voidaan tarkistaa getwd-komennolla: getwd() # Tulostaa tämänhetkisen työkansion ## [1] &quot;C:/Users/samuliko/OneDrive - University of Eastern Finland/Documents/R_kurssi&quot; Työskentelyn helpottamiseksi tiedostot kannattaa siirtää työkansioon tai työkansio voidaan muuttaa setwd-komennolla: # setwd(&quot;C:/foo/bar/R_kurssi&quot;) Harjoitus: Luo itsellesi työkansio, johon tallennat tämän kurssin materiaalit ja aseta se työkansioksi 1.5.1 Funktiot Edellä on jo suoritettu joitakin funktioita. Funktiot ovat muotoa nimi(parametri 1, parametri2..). 1.6 Aineiston tuominen R:ään 1.6.1 European Social Survey 2016 Kurssin opetuksessa käytetään European Social Survey (ESS) Suomen aineistoa vuodelta 2016. Haastattelututkimus, joka kartoittaa yhteiskunnalliseen kehitykseen liittyvää arvojen, asenteiden ja käyttäytymisen muutosta. ESS kerää vertailukelpoista surveydataa noin 30 Euroopan maasta. Lisätietoja Uusin saatavissa oleva Suomen aineisto on 8. kierrokselta (vuosi 2016). Sen teemoina on mm. ilmastonmuutos, energiavarmuus ja hyvinvointi FSD3217 European Social Survey 2016: Suomen aineiston on Tietoarkiston kautta vapaasti käytettävissä ilman rekisteröitymistä. Lataa aineisto täältä seuraavaan harjoituskertaan mennessä Aineisto kannattaa tallentaa omaan (UEFin) o365 OneDriveen, jolloin se on käytettävissä kaikilla työasemilla ess &lt;- read.csv2(&quot;FSD3217/Study/Data/daF3217.csv&quot;) 1.7 Valmiin aineiston tuominen R:ään Ohjeet löytyvät täältä # Asennetaan &quot;memisc&quot;-niminen paketti install.packages(&#39;memisc&#39;) # Otetaan käyttöön kyseinen paketti library(memisc) # Ladataan aineisto R:ään, korjaa polku tiedostoon oikeaksi eli # laita &quot;D:/data.por&quot; tilalle se tiedostopolku, johon talletit datan ds &lt;- as.data.set(spss.portable.file(&quot;D:/data.por&quot;)) # Muutetaan heti useammin käytettyyn dataframe-muotoon df &lt;- as.data.frame(ds) 1.8 Aineiston käsitteleminen Siinä missä muissa tilasto-ohjelmissa (esim. SPSS ja Stata) voi olla auki vain yksi aineisto kerrallaan, R:ssä voi olla samanaikaisesti auki monta aineistoa, muuttujaa ja matriisia. Tästä syystä komennoissa pitää myös viitata siihen aineistoon, jolla analyysin haluaa tehdä. R käsittelee aineistoa matriisina. Esimerkiksi tällä kurssilla käytettävän ESS-aineiston R käsittää 1925*309 matriisina. dim(ess) ## [1] 1925 309 1.9 Valmiin aineiston tarkastelu Juuri tuotu aineisto on täysin koskematon eikä R tiedä, mitkä arvot ovat esimerkiksi puuttuvia arvoja. Tarkastellaan seuraavassa muuttujaa b30, “Kuinka tyytyväinen olet siihen, kuinka demokratia toimii Suomessa?”. Vastausvaihtoehtojen tulisi vaihdella välillä 0-10, mutta havaitaan joukossa olevan myös muitakin arvoja. table(ess$b30) ## ## 0 1 2 3 4 5 6 7 8 9 10 99 ## 26 30 59 124 150 221 236 421 435 159 30 34 Huomataan, että arvot vaihtelevat välillä 1–99. ESS:n ohjekirjan mukaan arvo 99 on koodattu tarkoittamaan “En osaa sanoa” -vaihtoehtoa. Sijoitetaan arvo NA niihin soluihin, joiden arvo on 99. ess$b30[ess$b30 == 99] &lt;- NA Sama operaatio voidaan tehdä hiukan mutkikkaamin replace-komennolla. Komento sijoittaa aineiston sarakkeeseen b30 (ess$b30) kyseisen sarakkeen, jonka arvot 99 on korvattu NA:lla. ess$b30 &lt;- replace(ess$b30, ess$b30 == 99, NA) table(ess$b30) ## ## 0 1 2 3 4 5 6 7 8 9 10 ## 26 30 59 124 150 221 236 421 435 159 30 1.10 Uuden muuttujan luominen aineistoon Aineistoon voidaan luoda uusia muuttujia helposti. Seuraavassa luodaan ensin muuttuja sukupuoli, jolle asetetaan arvoksi vain puuttuvia vastauksia, jonka jälkeen se lisätään ess-data kehikkoon. sukupuoli &lt;- NA ess$sukupuoli &lt;- sukupuoli 1.11 Muuttujan poistaminen aineistosta Muuttuja tai muuttujia voidaan poistaa aineistosta samalla logiikalla. ess$sukupuoli &lt;- NULL 1.12 Aineiston kuvailu Lasketaan muuttujalle B30 keskiarvo ja -hajonta mean(ess$b30) ## [1] NA sd(ess$b30) ## [1] NA R on varovainen puuttuvien arvojen suhteen eikä laske keskiarvoa, jos mukana on puuttuvia arvoja (NA = Not Available). R siis pitää huolen siitä, ettei käyttäjä hölmöile. On mietittävä, vaikuttavatko puuttuvat arvot tulokseen ja/tai tulkintaan. Jos ei, R:n voi käskeä laskemaan keskiarvon ja -hajonnan ilman puuttuvia arvoja na.rm = TRUE -asetuksella. Tämä jättää puuttuvat arvot huomiotta. mean(ess$b30, na.rm = TRUE) ## [1] 6.239556 sd(ess$b30, na.rm = TRUE) ## [1] 2.124496 Puuttuvia arvoja voidaan kartoittaa esimerkiksi is.na-komennolla. Se on looginen funktio, joka palauttaa arvon FALSE, kun arvo ei puutu, ja arvon TRUE, kun arvo puuttuu. Huomaa, että puuttuvia arvoja löytyy vain tästä muuttujasta, koska se on ainoa muuttuja jolle ne on määritelty. is.na(ess$b30) ## [1] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE ## [21] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE ## [41] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE TRUE FALSE FALSE FALSE FALSE ## [61] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE ## [81] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE ## [101] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE ## [121] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE ## [141] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE ## [161] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE ## [181] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE ## [201] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE ## [221] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE ## [241] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE ## [261] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE ## [281] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE ## [301] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE ## [321] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE ## [341] FALSE FALSE FALSE FALSE FALSE FALSE TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE ## [361] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE ## [381] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE ## [401] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE ## [421] FALSE FALSE FALSE FALSE FALSE FALSE TRUE FALSE FALSE FALSE TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE ## [441] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE ## [461] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE TRUE FALSE FALSE FALSE FALSE ## [481] FALSE FALSE FALSE FALSE FALSE TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE ## [501] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE ## [521] FALSE FALSE FALSE FALSE FALSE FALSE TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE ## [541] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE ## [561] FALSE FALSE FALSE FALSE TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE ## [581] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE ## [601] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE TRUE FALSE FALSE ## [621] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE ## [641] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE ## [661] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE ## [681] FALSE FALSE FALSE TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE ## [701] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE ## [721] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE ## [741] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE ## [761] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE ## [781] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE ## [801] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE TRUE FALSE FALSE FALSE FALSE ## [821] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE ## [841] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE ## [861] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE ## [881] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE ## [901] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE ## [921] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE ## [941] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE ## [961] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE ## [981] FALSE FALSE FALSE FALSE TRUE FALSE TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE ## [ reached getOption(&quot;max.print&quot;) -- omitted 925 entries ] Tällainen lista ei kuitenkaan ole kovin käyttökelpoinen. Summataan puuttuvat havainnot yhteen lukuun, jolloin nähdään suoraan puuttuvien havaintojen määrä. sum(is.na(ess$b30)) ## [1] 34 ► "],["harjoituskerta-2.html", "2 Harjoituskerta 2 2.1 Aineiston kuvailu", " 2 Harjoituskerta 2 Osa Käsiteltävät asiat (viitteellinen asiasisältö, muutoksia voi tulla) 1 RStudioon ja R-kieleen tutustuminen 2 Aineiston kuvailu: frekvenssijakauma, tunnusluvut, kuviot, osa-aineiston poimiminen ja aineston ryhmittäinen tarkastelu 3 Yksinkertaiset muuttujamuunnokset, kahden muuttujan välinen yhteisvaihtelu, ristiintaulukointi 4 Korrelaatiot ja hajotakuvio, summamuuttujan tekeminen 5 Keskiarvotestit: t-testi ja ANOVA 6 Kertausta ja ohjausta ryhmätehtävään Tarkastellaan onko miesten ja naisten (f2_1) välillä eroa sen suhteen, mikä on korkein koulutus, jonka vastaaja on suorittanut (f15). HUOM! Sukupuoli 1 = mies, 2 = nainen. Koulutus on välillä 1-15. Poistetaan siis ensin puuttuvat arvot (=99). ess$f15[ess$f15 == 99] &lt;- NA table(ess$a2, ess$b30) ## ## 0 1 2 3 4 5 6 7 8 9 10 ## 1 2 3 6 22 18 31 33 36 41 7 4 ## 2 3 2 5 3 5 11 3 16 12 2 1 ## 3 0 0 3 6 7 13 8 22 21 9 0 ## 4 1 3 3 6 8 10 12 19 25 4 2 ## 5 20 22 42 87 112 156 180 328 336 137 23 # Yksittäinen muuttuja voidaan myös kopioda omaksi muuttujakseen ja ottaa frekvenssit siitä internet &lt;- ess$a2 table(internet) ## internet ## 1 2 3 4 5 ## 223 63 90 93 1456 2.1 Aineiston kuvailu 2.1.1 Histogrammi Histogrammin, joka kuvaa havaintojen jakaumaa saa helposti hist-komennolla. hist(ess$b30) Mikäli histogrammi on liian karkea tai hienojakoinen, palkkien määrää voidaan muuttaa break -asetuksella. Vaaka- ja pystyakselien pituutta xlim ja ylim -asetuksilla. hist(aly, breaks = 20, xlim = c(0, 200), ylim = c(0, 200) ) 2.1.2 Hajontakuvio (plot) Erilaisia yhden tai kahden muuttujan kuvaajia saa tehtyä plot-komennolla. Esimerkiksi ensimmäisellä harjoituskerralla tehty älykkyysosamäärä voidaan kuvata seuraavalla komennolla: plot(aly, main = &quot;Vastaajien ÄO&quot;, xlab = &quot;ID&quot;, ylab = &quot;Älykkyysosamäärä&quot;) abline(h = c(70, 130), col = &quot;red&quot;) Huomaa, että komennossa on paljon “ylimääräistä”, pelkkä plot(aly) olisi tuottanut kuvion ilman selitystekstejä ja viivoja. Komennot main, xlab ja ylab ovat yleisesti käytettyjä asetuksia kaikissa R:n grafiikkakomennoissa. R tunnistaa muuttujan tyypin ja tekee kuvion sen mukaisesti. Edellisessä kuviossa käytetty muuttuja oli numeraalinen, jonka takia kuviosta tuli hajontakuvio. Seuraavassa tehdään uusi muuttuja sukupuolesta ja muutetaan se samalla luokkamuuttujaksi. sukupuoli &lt;- as.factor(ess$f2_1) plot(sukupuoli) 2.1.3 Boxplot 2.1.4 Ristiintaulukointi taulukko &lt;- table(ess$f2_1, ess$b30) taulukko ## ## 0 1 2 3 4 5 6 7 8 9 10 ## 1 17 16 30 58 90 89 113 213 209 96 23 ## 2 9 14 29 66 60 132 123 208 226 63 7 prop.table(taulukko) ## ## 0 1 2 3 4 5 6 7 8 9 ## 1 0.008989952 0.008461132 0.015864622 0.030671602 0.047593866 0.047065045 0.059756742 0.112638815 0.110523533 0.050766790 ## 2 0.004759387 0.007403490 0.015335801 0.034902168 0.031729244 0.069804336 0.065044950 0.109994712 0.119513485 0.033315706 ## ## 10 ## 1 0.012162877 ## 2 0.003701745 Frekvenssijakaumat Muuttujan frekvenssijakaumaa voi tutkia funktiolla table. Prosenttijakauman saa näkymään funktiolla prop.table, jolle annetaan argumentiksi table-objekti. frekvenssitaulu &lt;- table(df$F11, useNA = &quot;always&quot;) frekvenssitaulu ## ## Avioliitto Rekisteröity parisuhde ## 24 11 ## Asumusero (yhä virallisesti naimisissa) Eronnut/rekisteröity parisuhde purettu ## 7 230 ## Leski/rekisteröidyn parisuhteen toinen osapuoli kuollut Ei mikään edellä mainituista ## 122 630 ## Kieltäytyy EOS ## 0 2 ## &lt;NA&gt; ## 899 prop.table(frekvenssitaulu) ## ## Avioliitto Rekisteröity parisuhde ## 0.012467532 0.005714286 ## Asumusero (yhä virallisesti naimisissa) Eronnut/rekisteröity parisuhde purettu ## 0.003636364 0.119480519 ## Leski/rekisteröidyn parisuhteen toinen osapuoli kuollut Ei mikään edellä mainituista ## 0.063376623 0.327272727 ## Kieltäytyy EOS ## 0.000000000 0.001038961 ## &lt;NA&gt; ## 0.467012987 Pylväsdiagrammi # Muutetaan kuvan marginaaleja par(mar=c(10, 4, 4, 4)) # Jaetaan merkkijonot useammalle riville, niin näkyvät paremmin kuvassa levels(df$F11) &lt;- str_wrap(levels(df$F11), 20) frekvenssitaulu &lt;- table(df$F11, useNA = &quot;always&quot;) # las-parametri vaihtaa x-akselin labeleiden suunnan, space-parametrilla muutetaan # pylväiden etäisyyksiä, cex.names-parametrilla muutetaan x-akselin tekstin kokoa barplot(frekvenssitaulu, las = 2, space = c(0.5), cex.names = 0.75) "],["harjoituskerta-3.html", "3 Harjoituskerta 3 3.1 Muuttujien muunnokset 3.2 Ristiintaulukointi", " 3 Harjoituskerta 3 Osa Käsiteltävät asiat (viitteellinen asiasisältö, muutoksia voi tulla) 1 RStudioon ja R-kieleen tutustuminen 2 Aineiston kuvailu: frekvenssijakauma, tunnusluvut, kuviot, osa-aineiston poimiminen ja aineston ryhmittäinen tarkastelu 3 Yksinkertaiset muuttujamuunnokset, kahden muuttujan välinen yhteisvaihtelu, ristiintaulukointi 4 Korrelaatiot ja hajotakuvio, summamuuttujan tekeminen 5 Keskiarvotestit: t-testi ja ANOVA 6 Kertausta ja ohjausta ryhmätehtävään 3.1 Muuttujien muunnokset Alkuperäisiä muuttujia muunnetaan tai luokitellaan uudelleen Tavoitteena on esim. aineiston kuvailun tai analysoinnin helpottuminen / mahdollistaminen ja tulkintojen helpottuminen Esimerkiksi: aineistossa saatavilla oleva muuttuja on vastaajan syntymävuosi, mutta haluamme raportoida vastaajan iän → syntymävuosimuuttuja muunnetaan kuvaamaan vastaajan ikää Toinen esimerkki 2: muuttuja tulee luokitella ennen ristiintaulukointia → jatkuva ikämuuttuja muunnetaan ikäryhmiä kuvaavaksi muuttujaksi Usein käytettyjä muuttujamuunnoksia on myös uudelleenkoodaus (recode) Uudelleenkoodatessa muuttujia alkuperäisen muuttujan arvot vaihdetaan uusiin arvoihin Tarpeen esim. kun halutaan kääntää alkuperäisen muuttujan “suunta” = pienet arvot muutetaan suuriksi arvoiksi ja päinvastoin. Huom! tärkeää summamuuttujia luodessa Muuttujan uudelleenluokittelu (yhdistetään muuttujan luokkia) Muuttujan luokkia yhdistetään usein silloin, kun luokassa on liian vähän havaintoja Esim. Khiin nekiön testin oletukset eivät toteudu → Yhdistetään frekvenssiltään pienimmät luokat Luokkien yhdistämisellä täytyy aina olla myös sisällöllisiä / teoreettisia perusteluja Harjoitus a: Uudelleenluokitellaan muuttuja C7. library(tidyverse) # Varmistetaan, että muuttuja C7 on luokaltaan faktori class(df$C7) ## [1] &quot;factor&quot; # Muuttujan frekvenssijakauma table(df$C7, useNA = &quot;always&quot;) ## ## Erittäin hyvä Hyvä Kohtuullinen Huono Erittäin huono Kieltäytyy EOS &lt;NA&gt; ## 423 895 519 76 10 1 1 0 # Tehdään aineistoon kopio muuttujasta C7 ja asetetaan sen nimeksi terveys df$terveys &lt;- df$C7 # Tutkitaan funktion levels-avulla faktorin tasoja levels(df$terveys) ## [1] &quot;Erittäin hyvä&quot; &quot;Hyvä&quot; &quot;Kohtuullinen&quot; &quot;Huono&quot; &quot;Erittäin huono&quot; &quot;Kieltäytyy&quot; &quot;EOS&quot; # Yhdistetään luokat Huono ja Erittäin huono levels(df$terveys)[c(4, 5)] &lt;- &quot;Huono tai erittäin huono&quot; table(df$terveys, useNA = &quot;always&quot;) ## ## Erittäin hyvä Hyvä Kohtuullinen Huono tai erittäin huono Kieltäytyy ## 423 895 519 86 1 ## EOS &lt;NA&gt; ## 1 0 Harjoitus b: Muodostetaan kurssin harjoitusainestoon ikämuuttuja, joka kertoo henkilön iän vuonna 2022. df$ika_v22 &lt;- 2022 - df$F3_1 ## Min. 1st Qu. Median Mean 3rd Qu. Max. ## 21.00 40.00 57.00 55.94 71.00 104.00 Harjoitus c: Luokitellaan juuri luotu ikämuuttuja neljään luokkaan. # Käytetään cut-funktiota tähän # Kts. ?cut df$ika_kategorinen &lt;- cut(df$ika_v22, breaks = c(0, 30, 50, 65, Inf), labels = c(&quot;luokka1_30_tai_alle&quot;, &quot;luokka2_31_50&quot;, &quot;luokka3_51_65&quot;, &quot;luokka4_yli66&quot;), include.lowest = TRUE) # Piirretään kuvaaja plot(df$ika_kategorinen) # Frekvenssijakauma table(df$ika_kategorinen) ## ## luokka1_30_tai_alle luokka2_31_50 luokka3_51_65 luokka4_yli66 ## 215 548 495 667 prop.table(table(df$ika_kategorinen)) ## ## luokka1_30_tai_alle luokka2_31_50 luokka3_51_65 luokka4_yli66 ## 0.1116883 0.2846753 0.2571429 0.3464935 3.2 Ristiintaulukointi Harjoitus: Tarkastellaan,o onko miesten ja naisten välillä eroa sen suhteen, mikä on korkein koulutus, jonka vastaaja on suorittanut koul_sp &lt;- table(df$F15, df$F2_1) koul_sp ## ## Mies Nainen ## Vähemmän kuin peruskoulun ala-aste tai vähemmän kuin kansakoulu 13 10 ## Peruskoulun ala-aste, kansakoulu tai kansalaiskoulu 95 98 ## Peruskoulun yläaste tai keskikoulu 82 84 ## Lukio, ylioppilastutkinto 59 60 ## Ammatillinen perustutkinto, ammattitutkinto 285 223 ## Sekä ylioppilas- että ammattitutkinto 32 37 ## Erikoisammattitutkinto 32 13 ## Ammatillinen opistoasteen tutkinto 113 109 ## Amm.kork.koulu tai amm. korkea-asteen tutkinto 77 108 ## Alempi korkeakoulututkinto, kandidaatin tutkinto 34 77 ## Ylempi ammattikorkeakoulututkinto 13 22 ## Ylempi korkeakoulututkinto 110 106 ## Lisensiaatin tutkinto 5 9 ## Tohtorin tutkinto 8 7 ## Joku muu 2 0 ## Kieltäytyy 0 0 ## EOS 1 1 # Huom. margin-argumentin arvo 2, jonka avulla lasketaan koulutuksen prosentuaalinen # jakautuminen sukupuolittain # ?prop.table prop.table(koul_sp, margin = 2) ## ## Mies Nainen ## Vähemmän kuin peruskoulun ala-aste tai vähemmän kuin kansakoulu 0.013527575 0.010373444 ## Peruskoulun ala-aste, kansakoulu tai kansalaiskoulu 0.098855359 0.101659751 ## Peruskoulun yläaste tai keskikoulu 0.085327784 0.087136929 ## Lukio, ylioppilastutkinto 0.061394381 0.062240664 ## Ammatillinen perustutkinto, ammattitutkinto 0.296566077 0.231327801 ## Sekä ylioppilas- että ammattitutkinto 0.033298647 0.038381743 ## Erikoisammattitutkinto 0.033298647 0.013485477 ## Ammatillinen opistoasteen tutkinto 0.117585848 0.113070539 ## Amm.kork.koulu tai amm. korkea-asteen tutkinto 0.080124870 0.112033195 ## Alempi korkeakoulututkinto, kandidaatin tutkinto 0.035379813 0.079875519 ## Ylempi ammattikorkeakoulututkinto 0.013527575 0.022821577 ## Ylempi korkeakoulututkinto 0.114464100 0.109958506 ## Lisensiaatin tutkinto 0.005202914 0.009336100 ## Tohtorin tutkinto 0.008324662 0.007261411 ## Joku muu 0.002081165 0.000000000 ## Kieltäytyy 0.000000000 0.000000000 ## EOS 0.001040583 0.001037344 # Koulutus muuttujan frekvenssijakauma - onko syytä yhdistellä luokkia? table(df$F15, useNA = &quot;always&quot;) ## ## Vähemmän kuin peruskoulun ala-aste tai vähemmän kuin kansakoulu Peruskoulun ala-aste, kansakoulu tai kansalaiskoulu ## 23 193 ## Peruskoulun yläaste tai keskikoulu Lukio, ylioppilastutkinto ## 166 119 ## Ammatillinen perustutkinto, ammattitutkinto Sekä ylioppilas- että ammattitutkinto ## 508 69 ## Erikoisammattitutkinto Ammatillinen opistoasteen tutkinto ## 45 222 ## Amm.kork.koulu tai amm. korkea-asteen tutkinto Alempi korkeakoulututkinto, kandidaatin tutkinto ## 185 111 ## Ylempi ammattikorkeakoulututkinto Ylempi korkeakoulututkinto ## 35 216 ## Lisensiaatin tutkinto Tohtorin tutkinto ## 14 15 ## Joku muu Kieltäytyy ## 2 0 ## EOS &lt;NA&gt; ## 2 0 # Tehdään uusi koulutus-muuttuja, jossa luokkia on yhdistelty df$koulutus &lt;- df$F15 # Luokitellaan uudelleen levels(df$koulutus) &lt;- c(&quot;Perusaste&quot;, &quot;Perusaste&quot;, &quot;Perusaste&quot;, &quot;Toinen_aste&quot;,&quot;Toinen_aste&quot;, &quot;Toinen_aste&quot;,&quot;Toinen_aste&quot;, &quot;Toinen_aste&quot;, &quot;Alempi_korkea&quot;, &quot;Alempi_korkea&quot;, &quot;Ylempi_korkea&quot;,&quot;Ylempi_korkea&quot;, &quot;Lisensiaatti_tohtori&quot;, &quot;Lisensiaatti_tohtori&quot;, NA, NA, NA) # Uuden koulutusmuuttujan ja sukupuolen ristiintaulkointi uusi_koul_sp &lt;- table(df$koulutus, df$F2_1) prop.table(uusi_koul_sp, 2) ## ## Mies Nainen ## Perusaste 0.19832985 0.19937695 ## Toinen_aste 0.54384134 0.45898235 ## Alempi_korkea 0.11586639 0.19210800 ## Ylempi_korkea 0.12839248 0.13291796 ## Lisensiaatti_tohtori 0.01356994 0.01661475 3.2.1 Ristiintaulukointi ja \\(\\chi^2\\)-testi Tutkitaan onko parisuhdestatuksella (tilastollista) yhteyttä siihen, miten kokee kotitalouden tulojen riittävyyden. Tee ristiintaulukko muuttujista: [F2_1] Vastaajan sukupuoli ja [C6] Kuinka turvalliseksi tunnet olosi kävellessäsi yksin illalla asuinalueellasi? ja testaa mahdollisen eron tilastollinen merkitsevyys Khiin neliön testillä Jos testitulos antaa aihetta uskoa, että nollahypoteesi voidaan hylätä (jos p&lt;0.05), todetaan, että muuttujien välillä on yhteys perusjoukossa. H0: Muuttujat ovat toisistaan riippumattomia H1: Muuttujien välillä on riippuvuutta Lue myös Ristiintaulukon riippumattomuustesti table(df$C6) ## ## Erittäin turvalliseksi Turvalliseksi Turvattomaksi Erittäin turvattomaksi Kieltäytyy ## 845 918 136 20 0 ## EOS ## 6 # Tiputetaan tässä vaiheessa pois faktoritaso &quot;Kieltäytyy&quot;, koska siinä ei ole havaintoja levels(df$C6)[5] &lt;- NA turv_sp &lt;- table(df$C6, df$F2_1) # Tehdään khiin neliötesi chisq.test(turv_sp) ## Warning in chisq.test(turv_sp): Chi-squared approximation may be incorrect ## ## Pearson&#39;s Chi-squared test ## ## data: turv_sp ## X-squared = 185.13, df = 4, p-value &lt; 2.2e-16 # Huomaa varoitus # Poistetaan myös luokka EOS levels(df$C6)[5] &lt;- NA turv_sp &lt;- table(df$C6, df$F2_1) prop.table(turv_sp, 2) ## ## Mies Nainen ## Erittäin turvalliseksi 0.578125000 0.302398332 ## Turvalliseksi 0.395833333 0.561001043 ## Turvattomaksi 0.021875000 0.119916580 ## Erittäin turvattomaksi 0.004166667 0.016684046 # Tehdään testi uudestaan chisq.test(turv_sp) ## ## Pearson&#39;s Chi-squared test ## ## data: turv_sp ## X-squared = 182.47, df = 3, p-value &lt; 2.2e-16 "],["harjoituskerta-4.html", "4 Harjoituskerta 4", " 4 Harjoituskerta 4 Osa Käsiteltävät asiat (viitteellinen asiasisältö, muutoksia voi tulla) 1 RStudioon ja R-kieleen tutustuminen 2 Aineiston kuvailu: frekvenssijakauma, tunnusluvut, kuviot, osa-aineiston poimiminen ja aineston ryhmittäinen tarkastelu 3 Yksinkertaiset muuttujamuunnokset, kahden muuttujan välinen yhteisvaihtelu, ristiintaulukointi 4 Korrelaatiot ja hajotakuvio, summamuuttujan tekeminen 5 Keskiarvotestit: t-testi ja ANOVA 6 Kertausta ja ohjausta ryhmätehtävään "],["harjoituskerta-5.html", "5 Harjoituskerta 5", " 5 Harjoituskerta 5 Osa Käsiteltävät asiat (viitteellinen asiasisältö, muutoksia voi tulla) 1 RStudioon ja R-kieleen tutustuminen 2 Aineiston kuvailu: frekvenssijakauma, tunnusluvut, kuviot, osa-aineiston poimiminen ja aineston ryhmittäinen tarkastelu 3 Yksinkertaiset muuttujamuunnokset, kahden muuttujan välinen yhteisvaihtelu, ristiintaulukointi 4 Korrelaatiot ja hajotakuvio, summamuuttujan tekeminen 5 Keskiarvotestit: t-testi ja ANOVA 6 Kertausta ja ohjausta ryhmätehtävään "],["harjoituskerta-6.html", "6 Harjoituskerta 6", " 6 Harjoituskerta 6 Osa Käsiteltävät asiat (viitteellinen asiasisältö, muutoksia voi tulla) 1 RStudioon ja R-kieleen tutustuminen 2 Aineiston kuvailu: frekvenssijakauma, tunnusluvut, kuviot, osa-aineiston poimiminen ja aineston ryhmittäinen tarkastelu 3 Yksinkertaiset muuttujamuunnokset, kahden muuttujan välinen yhteisvaihtelu, ristiintaulukointi 4 Korrelaatiot ja hajotakuvio, summamuuttujan tekeminen 5 Keskiarvotestit: t-testi ja ANOVA 6 Kertausta ja ohjausta ryhmätehtävään "]]
